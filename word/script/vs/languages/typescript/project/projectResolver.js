/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";define("vs/base/db/indexeddb",["require","exports","vs/base/types","vs/base/lib/winjs.base","vs/base/errors"],function(e,t,n,r,i){function o(){return"undefined"!=typeof indexedDB}function s(e,t,n){return new r.TPromise(function(r,i){var o;o="undefined"!=typeof t?indexedDB.open(e,t):indexedDB.open(e),o.onerror=function(e){return i(e)},o.onsuccess=function(e){return r(new u(e.target.result))},o.onupgradeneeded=function(e){if(!n)return i(e);var t=e.target.result;n({createDataStore:function(e){var n=t.createObjectStore(e.name,{keyPath:e.keyPath,autoIncrement:e.autoIncrement});e.index&&e.index.forEach(function(e){return n.createIndex(e.name,e.keyPath,e.options)})},deleteDataStore:function(e){t.deleteObjectStore(e)}},t)}})}function a(e){return new r.TPromise(function(t,n){e.onsuccess=function(){t(e)},e.onerror=function(t){n(e.error||t)}})}t.canBeUsed=o,function(e){e[e.ReadOnly=0]="ReadOnly",e[e.ReadWrite=1]="ReadWrite",e[e.VersionChange=2]="VersionChange"}(t.TransactionMode||(t.TransactionMode={}));var l=t.TransactionMode;!function(e){function t(t){return e[t]?e[t].toLowerCase():null}e.toString=t}(t.TransactionMode||(t.TransactionMode={}));var l=t.TransactionMode;!function(e){e[e.Next=0]="Next",e[e.NextUnique=1]="NextUnique",e[e.Prev=2]="Prev",e[e.PrevUnique=3]="PrevUnique"}(t.Direction||(t.Direction={}));var c=t.Direction;!function(e){function t(t){return e[t]?e[t].toLowerCase():null}e.toString=t}(t.Direction||(t.Direction={}));var c=t.Direction;t.openDatabase=s;var u=function(){function e(e){this._db=e}return Object.defineProperty(e.prototype,"db",{get:function(){return this._db},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._db.close()},e.prototype.createTransaction=function(e,t){return"undefined"!=typeof t?this._db.transaction(e,l.toString(t)):this._db.transaction(e)},e.prototype.objectStore=function(e){return this._db.objectStoreNames.contains(e)?new p(e,this):null},e}();t.Database=u;var p=function(){function e(e,t){this._name=e,this._database=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._database.db.transaction(this._name).objectStore(this._name)},enumerable:!0,configurable:!0}),e.prototype.executeTransaction=function(e,t){var n=this;return new r.TPromise(function(r,o){var s,a=n._database.db.transaction(n._name,l.toString(e));a.onerror=function(e){return o(e.target.error)},a.oncomplete=function(){return r(s)},a.onabort=function(){return o(i.canceled())};try{s=t(a.objectStore(n._name),a)}catch(c){a.abort(),o(c)}})},e.prototype.openCursor=function(e,t,n,r){return d.openCursor(this,null,e,t,n,r)},e.prototype.index=function(e){if(!this.store.indexNames.contains(e)){for(var t=[],n=0,r=this.store.indexNames.length;r>n;n++)t.push(this.store.indexNames.item(n));throw i.illegalArgument("Invalid index name: '"+e+"'. Allowed names are: "+t.join(", "))}return new h(e,this)},e.prototype.get=function(e){return this.executeTransaction(0,function(t){return a(t.get(e))}).then(function(e){return e}).then(function(e){return e.result})},e}();t.ObjectStore=p;var h=function(){function e(e,t){this._name=e,this._store=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this._store.store.index(this._name)},enumerable:!0,configurable:!0}),e.prototype.openCursor=function(e,t,n,r){return d.openCursor(this._store,this._name,e,t,n,r)},e}();t.Index=h;var d;!function(e){function t(e,t,i,o,s,a){var l,u=0;return n.isFunction(o)?a=o:n.isFunction(s)?(l=o,a=s):(l=o,u=s),new r.TPromise(function(n,r){var o,s=[];e.executeTransaction(i,function(e){var n;n=t?e.index(t).openCursor(l,c.toString(u)):e.openCursor(l,c.toString(u)),n.onsuccess=function(t){var n=t.target;n.result&&s.push(a(n.result.value,n.result,e))},n.onerror=function(e){return o=e}}).then(function(){o?r(o):n(s)},r)})}e.openCursor=t}(d||(d={}))}),define("vs/platform/configuration/configurationRegistry",["require","exports","vs/nls!vs/languages/typescript/project/projectResolver","vs/platform/platform","vs/base/objects"],function(e,t,n,r,i){t.Extensions={Configuration:"base.contributions.configuration"};var o=function(){function e(){this.configurationContributors=[],this.masterConfiguration={id:"configurationFile",title:n.localize("vs_platform_configuration_configurationRegistry",0),description:n.localize("vs_platform_configuration_configurationRegistry",1),type:"object",properties:{type:{type:"string",description:n.localize("vs_platform_configuration_configurationRegistry",2)},languages:{type:"object",description:n.localize("vs_platform_configuration_configurationRegistry",3),properties:{}}}}}return e.prototype.registerConfiguration=function(e){e=i.clone(e),this.configurationContributors.push(e),this.registerConfigurationNode(this.masterConfiguration,e.id.split("/"),e.id)},e.prototype.registerConfigurationNode=function(e,t,n){if(1===t.length)e.properties[t[0]]={type:"ref",$ref:n};else{var r=t.shift();e.properties[r]||(e.properties[r]={type:"object",properties:{}}),this.registerConfigurationNode(e.properties[r],t,n)}},e.prototype.getConfigurations=function(){return this.configurationContributors.slice(0)},e.prototype.getConfigurationSchemas=function(){var e=this.getConfigurations();return e.push(this.masterConfiguration),e},e}();r.Registry.add(t.Extensions.Configuration,new o)}),define("vs/base/trie",["require","exports","vs/base/collections","vs/base/assert"],function(e,t,n,r){function i(e,t){"undefined"==typeof t&&(t=d);var r,i;return r={_key:null,_parent:null,_children:{},parent:function(){return null},children:function(e){return"undefined"==typeof e&&(e=!1),l(this,e)}},i={insert:function(e,n){return o(r,t(e),n)},lookUp:function(e,n){return"undefined"==typeof n&&(n=!1),s(r,t(e),n)},roots:function(){return l(r,!1)},values:function(){return c(r)},fringe:function(){return u(r)},remove:function(e){return p(e)}},"undefined"!=typeof e&&n.forEach(e,function(e){i.insert(e.key,e.value)}),i}function o(e,t,n){for(var r=0,i=t.length,o=e;i>r&&(o=e._children[t[r]]);)e=o,r+=1;for(;i>r;)o={_key:t[r],_parent:e,_children:{},parent:function(){return a(this)},children:function(e){return"undefined"==typeof e&&(e=!1),l(this,e)}},e._children[t[r]]=o,e=o,r+=1;return o.element=n,o}function s(e,t,n){for(var r=0,i=t.length,o=e,s=void 0!==o.element?o:void 0;i>r&&(o=e._children[t[r]]);)e=o,r+=1,void 0!==o.element&&(s=o);return o&&void 0!==o.element?o:n&&void 0!==s?s:null}function a(e){for(;e._parent;){if("undefined"!=typeof e._parent.element)return e._parent;e=e._parent}return null}function l(e,t){for(var r=[],i=n.values(e._children);i.length>0;)e=i.shift(),void 0!==e.element&&r.push(e),(t||void 0===e.element)&&i.push.apply(i,n.values(e._children));return r}function c(e){for(var t=[],r=[e];r.length>0;)e=r.pop(),void 0!==e.element&&t.push(e.element),n.forEach(e._children,function(e){r.push(e.value)});return t}function u(e){for(var t=[e],i=[];t.length>0;){var o=t.pop(),s=t.length;n.forEach(o._children,function(e){t.push(e.value)}),s===t.length&&null!==o._key&&(r.ok("undefined"!=typeof o.element),i.push(o))}return i}function p(e){return e._parent?e._parent._children[e._key]!==e?!1:(delete e._parent._children[e._key],"undefined"==typeof e._parent.element&&h(e._parent._children)&&p(e._parent),!0):!1}function h(e){if(!e)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var d=function(e){return e.split("")};t.newTrie=i}),define("vs/languages/typescript/typescript.configuration",["require","exports","vs/base/objects","vs/base/severity","vs/base/paths","vs/base/trie","vs/base/strings"],function(e,t,n,r,i,o,s){function a(e,t,n){return e instanceof c?e:new c(e,t,n)}function l(e,t){return e instanceof c&&(e=e.raw),t instanceof c&&(t=t.raw),n.equals(e,t)}t.impilictAnyClassifier=function(e){var t=/.*?(\d+):.*?/.exec(e.message());if(!t)return r.Severity.Error;var n=Number(t[1]);return isNaN(n)?r.Severity.Error:n>=7005&&7018>=n?r.Severity.Warning:r.Severity.Error},t.defaultLintSettings={emptyBlocksWithoutComment:"ignore",curlyBracketsMustNotBeOmitted:"ignore",comparisonOperatorsNotStrict:"ignore",missingSemicolon:"ignore",unknownTypeOfResults:"ignore",semicolonsInsteadOfBlocks:"ignore",functionsInsideLoops:"ignore",functionsWithoutReturnType:"ignore",tripleSlashReferenceAlike:"ignore",unusedImports:"ignore",unusedVariables:"ignore",unusedFunctions:"ignore",unusedMembers:"ignore"},t.defaultValidationSettings={target:"ES5",baseUrl:"",module:"",lint:t.defaultLintSettings},t._internalDefaultValidationSettings={scope:"/",baseUrl:"",noImplicitAny:!1,noLib:!1,extraLibs:["vs/text!vs/languages/typescript/lib/lib.d.ts"],semanticValidation:!0,syntaxValidation:!0,target:"ES5",module:"",lint:t.defaultLintSettings,diagnosticClassifier:t.impilictAnyClassifier},t.defaultSuggestSettings={alwaysAllWords:!1,useCodeSnippetsOnMethodSuggest:!1};var c=function(){function e(e,t,n){this._raw=e,this._defaultCompileSettings=t,this._defaultSuggestSettings=n}return Object.defineProperty(e.prototype,"raw",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validationSettings",{get:function(){return this._compileSettings||(this._compileSettings=this._ensureCompileSettings()),this._compileSettings.slice(0)},enumerable:!0,configurable:!0}),e.prototype._ensureCompileSettings=function(){var e=this;if(!this._raw||!this._raw.validationSettings)return[this._defaultCompileSettings];if(Array.isArray(this._raw.validationSettings)){if(0===this._raw.validationSettings.length)return[this._defaultCompileSettings]}else this._raw.validationSettings=[this._raw.validationSettings];var t=o.newTrie(),r=[],a=!1;this._raw.validationSettings.forEach(function(e){var r,o=e.scope;s.isFalsyOrWhitespace(o)?o=i.sep:(o=i.makeAbsolute(o),o=i.normalize(o)),e.scope=o,a=a||o===i.sep,s.isFalsyOrWhitespace(e.module)&&!s.isFalsyOrWhitespace(e.moduleGenTarget)&&(e.module=e.moduleGenTarget),s.isFalsyOrWhitespace(e.target)&&!s.isFalsyOrWhitespace(e.codeGenTarget)&&(e.target=e.codeGenTarget),r=t.lookUp(e.scope),r&&(e=n.withDefaults(e,r.element)),t.insert(e.scope,e)}),a||t.insert(i.sep,this._defaultCompileSettings);for(var l;(l=t.fringe()).length>0;)l.forEach(function(o){for(var s=o.element,a=o.parent(),l=[e._defaultCompileSettings];null!==a;)l.push(a.element),a=a.parent();for(;0!==l.length;)s=n.withDefaults(s,l.pop());s.baseUrl=i.normalize(s.baseUrl),s.baseUrl=i.makeAbsolute(s.baseUrl),t.remove(o),r.unshift(s)});return r.sort(function(e,t){return e.scope.length-t.scope.length}),r},Object.defineProperty(e.prototype,"suggestSettings",{get:function(){return this._suggestSettings||(this._suggestSettings=this._raw&&this._raw.suggestSettings?n.withDefaults(this._raw.suggestSettings,this._defaultSuggestSettings):this._defaultSuggestSettings),n.clone(this._suggestSettings)},enumerable:!0,configurable:!0}),e}();t.sanitize=a,t.equal=l}),define("vs/languages/typescript/typescript.contribution",["require","exports","vs/nls!vs/languages/typescript/project/projectResolver","vs/base/env","vs/platform/services","vs/platform/platform","vs/editor/modes/modesExtensions","vs/platform/configuration/configurationRegistry","./typescript.configuration"],function(e,t,n,r,i,o,s,a,l){!function(e){function t(e){r=e}function n(){return r}e.Identifier="vs.languages.typescript",o.Registry.add(e.Identifier,e);var r;e.setProjectResolver=t,e.getProjectResolver=n}(t.Extensions||(t.Extensions={}));var c=t.Extensions;!function(e){e.ResourceSetChanged="typescript.resourceSetChanged"}(t.Events||(t.Events={}));t.Events;c.setProjectResolver(new i.AsyncDescriptor("vs/languages/typescript/project/projectResolver","ProjectResolver",{modeId:"vs.languages.typescript",pattern:"**/*.ts"})),s.registerMode("vs.languages.typescript",["text/typescript"],"vs/languages/typescript/typescript","TypeScriptMode"),r.enableNLSWarnings&&s.registerWorkerParticipant("vs.languages.typescript","vs/languages/typescript/participants/nlsParticipant","WorkerParticipant"),s.registerWorkerParticipant("vs.languages.typescript","vs/languages/typescript/participants/filenameSuggestions","FilenameSuggestions");var u=o.Registry.as(a.Extensions.Configuration);u.registerConfiguration({id:s.LANGUAGE_CONFIGURATION+"/vs.languages.typescript",type:"object",title:n.localize("vs_languages_typescript_typescript.contribution",0),description:n.localize("vs_languages_typescript_typescript.contribution",1),properties:{suggestSettings:{type:"object",description:n.localize("vs_languages_typescript_typescript.contribution",2),default:l.defaultSuggestSettings,properties:{alwaysAllWords:{type:"boolean",default:!1,description:n.localize("vs_languages_typescript_typescript.contribution",3)},useCodeSnippetsOnMethodSuggest:{type:"boolean",default:!1,description:n.localize("vs_languages_typescript_typescript.contribution",4)}}},allowMultipleWorkers:{type:"boolean",description:n.localize("vs_languages_typescript_typescript.contribution",5),default:!1},validationSettings:{description:n.localize("vs_languages_typescript_typescript.contribution",6),default:l.defaultValidationSettings,type:"object",properties:{scope:{type:"string",default:"/",description:n.localize("vs_languages_typescript_typescript.contribution",7)},baseUrl:{type:"string",default:"",description:n.localize("vs_languages_typescript_typescript.contribution",8)},target:{enum:["ES5","ES3"],default:"ES5",description:n.localize("vs_languages_typescript_typescript.contribution",9)},module:{enum:["commonjs","amd",""],default:"",description:n.localize("vs_languages_typescript_typescript.contribution",10)},noImplicitAny:{type:"boolean",default:!1,description:n.localize("vs_languages_typescript_typescript.contribution",11)},noLib:{type:"boolean",default:!1,description:n.localize("vs_languages_typescript_typescript.contribution",12)},lint:{type:"object",description:n.localize("vs_languages_typescript_typescript.contribution",13),properties:{curlyBracketsMustNotBeOmitted:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",14)},emptyBlocksWithoutComment:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",15)},comparisonOperatorsNotStrict:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",16)},missingSemicolon:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",17)},reservedKeywords:{enum:["ignore","warning","error"],default:"error",description:n.localize("vs_languages_typescript_typescript.contribution",18)},typeScriptSpecifics:{enum:["ignore","warning","error"],default:"error",description:n.localize("vs_languages_typescript_typescript.contribution",19)},unknownTypeOfResults:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",20)},semicolonsInsteadOfBlocks:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",21)},functionsInsideLoops:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",22)},newOnLowercaseFunctions:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",23)},tripleSlashReferenceAlike:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",24)},unusedVariables:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",25)},unusedFunctions:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",26)},unusedMembers:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",27)},functionsWithoutReturnType:{enum:["ignore","warning","error"],default:"warning",description:n.localize("vs_languages_typescript_typescript.contribution",28)}}}}}}})});var __extends=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n};define("vs/languages/typescript/project/projectResolver",["require","exports","vs/base/env","vs/base/hash","vs/base/strings","vs/base/paths","vs/base/errors","vs/base/lifecycle","vs/base/collections","vs/base/db/indexeddb","vs/base/lib/winjs.base","vs/platform/services","vs/languages/typescript/typescript.contribution","vs/base/trie"],function(e,t,n,r,i,o,s,a,l,c,u,p,h,d){var m;!function(e){function t(e){return"monaco_"+r.computeMurmur2StringHashCode(e)}function n(t,n){return c.openDatabase(t,1,function(t,n){for(var r=0,i=n.objectStoreNames.length;i>r;r++)t.deleteDataStore(n.objectStoreNames.item(r));t.createDataStore({name:e.storeName,keyPath:e.keyPath,index:[e.workspaceIndexOptions]})}).then(function(t){return n.push(t),t.objectStore(e.storeName)},function(){return null})}e.databaseName=t,e.keyPath="workspaceAbsolutePath",e.storeName="cache",e.workspaceIndexOptions={name:"workspaceName",keyPath:"workspaceName",options:{unique:!1}},e.openStore=n}(m||(m={}));var f=function(){function e(){}return e.prototype.resolve=function(){return null},e.Instance=new e,e}();t.NullProjectResolver=f,function(e){function t(e,t,n){for(var r=d.newTrie({},function(e){return e.split(o.sep).filter(function(e){return!i.isFalsyOrWhitespace(e)})}),s=d.newTrie(),a=!1,l=0,c=e.length;c>l;l++){var u=e[l];u&&(2===u.type?s.insert(u.path,u):(1===u.type||0===u.type)&&r.insert(u.path,u))}s.roots().forEach(function(e){n(e.element.path),a=!0});for(var p=r.roots();p.length>0;){var h=p.shift(),u=h.element;if(1===u.type)t(u.path);else if(0===u.type){var m=h.children(),c=m.length;if(0===c)continue;for(var f=0,l=0;c>l;l++)1===m[l].element.type&&(f+=1);f>1?(t(u.path),a=!0):p.push.apply(p,m)}}return a}e.minimize=t}(t.RemoteFileEventProcessing||(t.RemoteFileEventProcessing={}));var g=t.RemoteFileEventProcessing,v=function(){function e(e,t){var n=this;this._fileService=e.rawFileService,this._eventService=e.eventService,this._options=t,this._disposables=[];var r=e.eventService.addListener(p.Files.EventType.REMOTE_FILE_CHANGES,function(e){var t=e.getRawEvents();g.minimize(t,function(e){return n._handleAdded(e)},function(e){return n._handleDelete(e)})&&n._eventService.emit(h.Events.ResourceSetChanged)});this._disposables.push({dispose:r}),this._pendingOperations=[u.TPromise.timeout(0).then(function(){return n._resolveStatsAndContents("/")})]}return e.prototype.dispose=function(){this._disposables=a.disposeAll(this._disposables)},e.prototype._handleDelete=function(e){this._pendingOperations.push(u.TPromise.as({removed:[e]}))},e.prototype._handleAdded=function(e){this._pendingOperations.push(this._resolveStatsAndContents(e))},e.prototype.resolve=function(){var e=this,t=this._pendingOperations.length;if(0===t)return u.TPromise.as({});if(this._resolverError)return u.TPromise.wrapError(this._resolverError);var n={added:[],removed:[],hasChanges:!1};return u.TPromise.join(this._pendingOperations.splice(0,t).map(function(t){return t.then(function(e){n.added.push.apply(n.added,e.added),n.removed.push.apply(n.removed,e.removed),n.hasChanges=n.hasChanges||e.hasChanges},function(t){if(!s.isPromiseCanceledError(t))throw e._resolverError=t,t})})).then(function(){return n},function(t){e._resolverError=t})},e.prototype._resolveStatsAndContents=function(e){var t=this;return this._fetchStats(e).then(function(n){return t._fetchContents(e,n)},function(e){if(404===e.status)return[];throw e}).then(function(e){return{added:e}})},e.prototype._fetchStats=function(e){return this._fileService.resolveFileStats(e,this._options.pattern)},e.prototype._fetchContents=function(e,t){return this._fileService.resolveContents(t.map(function(e){return e.path}))},e}(),y=function(){function e(){this._value=Object.create(null)}return e.prototype.change=function(){this._value=Object.create(null)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}(),b=function(e){function t(t,n){e.call(this,t,n),this._workspaceName=t.contextService.getWorkspace().name,this._databaseName=m.databaseName(n.modeId),this._state=new y}return __extends(t,e),t.prototype._getObjectStore=function(){return this._objectStorePromise||(this._objectStorePromise=m.openStore(this._databaseName,this._disposables)),this._objectStorePromise},t.prototype._handleDelete=function(t){var n=this;this._pendingOperations.push(this._getObjectStore().then(function(e){return e?e.index(m.workspaceIndexOptions.name).openCursor(1,IDBKeyRange.only(n._workspaceName),function(e,r,i){o.isEqualOrParent(e.content.path,t)&&(i.delete(e.workspaceAbsolutePath),n._state.change()),r.continue()}):void 0})),e.prototype._handleDelete.call(this,t)},t.prototype._resolveStatsAndContents=function(t){var n=this,r=this._state.value;return e.prototype._resolveStatsAndContents.call(this,t).then(function(e){return e.hasChanges=r!==n._state.value,e})},t.prototype._fetchContents=function(t,n){var r=this;return this._getObjectStore().then(function(i){return i?r._doFetchContents(i,t,n).then(function(e){return e.persistedContents.concat(e.volatileContents)}):e.prototype._fetchContents.call(r,t,n)})},t.prototype._doFetchContents=function(t,n,r){var i=this,a=o.join(this._workspaceName,n),c={},u={volatileContents:[],persistedContents:[]};return r.forEach(function(e){var t=o.join(i._workspaceName,e.path);if(l.lookupOrInsert(c,t,e)!==e)throw new Error("path collision between two different stat objects. path: "+t)}),t.index(m.workspaceIndexOptions.name).openCursor(1,IDBKeyRange.only(this._workspaceName),function(e,t,n){var r=l.lookup(c,e.workspaceAbsolutePath);o.isEqualOrParent(e.workspaceAbsolutePath,a)&&(r&&r.etag===e.content.etag?(delete c[e.workspaceAbsolutePath],u.persistedContents.push(e.content)):(n.delete(e.workspaceAbsolutePath),i._state.change())),t.continue()}).then(function(){return e.prototype._fetchContents.call(i,n,l.values(c))}).then(function(e){return t.executeTransaction(1,function(t){e.forEach(function(e){t.put({workspaceName:i._workspaceName,workspaceAbsolutePath:o.join(i._workspaceName,e.path),content:e}),i._state.change(),u.persistedContents.push(e)})}).then(void 0,function(t){if(!s.isPromiseCanceledError(t))throw t;u.volatileContents=e})}).then(function(){return u})},t}(v),_=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._doFetchContents=function(t,n,r){return e.prototype._doFetchContents.call(this,t,n,r).then(function(e){return e.persistedContents.length=0,e})},t}(b),w=function(){function e(e,t){this._delegate=e.rawFileService?c.canBeUsed()?n.browser.isFirefox?e.instantiationService.createInstance(b,t):e.instantiationService.createInstance(_,t):e.instantiationService.createInstance(v,t):f.Instance}return e.prototype.resolve=function(){return this._delegate.resolve()},e}();t.ProjectResolver=w;var T=function(){function e(e,t){this._disposables=[],this._workspaceName=e.contextService.getWorkspace().name,this._databaseName=m.databaseName(t)}return e.prototype.dispose=function(){this._disposables=a.disposeAll(this._disposables)},e.prototype.resolve=function(e){if(i.isFalsyOrWhitespace(this._workspaceName))return u.TPromise.as(null);var t=o.join(this._workspaceName,e);return this._getObjectStore().then(function(e){return e?e.get(t).then(function(e){return e?e.content:null}):null})},e.prototype.accept=function(e){var t,n=this;return new u.TPromise(function(r,i){n._getObjectStore().then(function(r){return r?r.index(m.workspaceIndexOptions.name).openCursor(1,IDBKeyRange.only(n._workspaceName),function(n,r){e(n.content),t||r.continue()}):void 0}).then(function(){return r(null)},i)},function(){t=s.canceled()})},e.prototype._getObjectStore=function(){return this._objectStorePromise||(this._objectStorePromise=m.openStore(this._databaseName,this._disposables)),this._objectStorePromise},e}();t.DatabaseContentResolver=T});